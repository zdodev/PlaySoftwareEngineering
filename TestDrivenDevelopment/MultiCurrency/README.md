## 목표

- 통화가 다른 두 금액을 더해서 주어진 환율레 맞게 변한 금액을 결과로 얻을 수 있어야 한다.
- 어떤 금액(주가)을 어떤 수(주식의 수)에 곱한 금액을 결과로 얻을 수 있어야 한다.

## Step 1 Multi-Currency Money

> - $5 + 10CHF = $10(환율이 2:1일 경우)
> - **$5 x 2  = $10**
> - amount를 private으로 만들기
> - Dollar 부작용(side effect)?
> - Money 반올림?

- 우리가 알고 있는 작업해야 할 테스트 목록을 만들었다.
- 오퍼레이션이 외부에서 어떻게 보이길 원하는지 말해주는 이야기를 코드로 표현했다.
- JUnit에 대한 상세한 사항들은 잠시 무시하기로 했다.
- 스텁 구현을 통해 테스트를 컴파일했다.
- 끔찍한 죄악을 범하여 테스트를 통과시켰다.
- 돌아가는 코드에서 상수를 변수로 변경하여 점진적으로 일반화했다.
- 새로운 할일들을 한번에 처리하는 대신 할일 목록에 추가하고 넘어갔다.

## Step 2 Degenerate Objects

> - $5 + 10CHF = $10(환율이 2:1일 경우)
> - ~~$5 x 2  = $10~~
> - amount를 private으로 만들기
> - **Dollar 부작용?**
> - Money 반올림?

- 설계상의 경함(Dollar 부작용)을 그 결함으로 인해 실패하는 테스트로 변환했다.
- 스텁 구현으로 빨게 컴파일을 통과하도록 만들었다.
- 올바르다고 생각하는 코드를 입력하여 테스트를 통과했다.

## Step 3 Equality for All

> - $5 + 10CHF = $10(환율이 2:1일 경우)
> - ~~$5 x 2  = $10~~
> - amount를 private으로 만들기
> - ~~Dollar 부작용?~~
> - Money 반올림?
> - **equals()**
> - hashCode()
> - Equal null
> - Equal object

- 우리는 디자인 패턴(값 객체, value object)이 하나의 또 다른 오퍼레이션을 암시한다는 걸 알아챘다.
- 해당 오퍼레이션을 테스트했다.
- 해당 오퍼레이션을 간단히 구현했다.
- 곧장 리팩토링하는 대신 테스트를 조금 더 했다.
- 두 경우를 모두 수용할 수 있도록 리팯토링했다.(일반화)

## Step 4 Privacy

> - $5 + 10CHF = $10(환율이 2:1일 경우)
> - ~~$5 x 2  = $10~~
> - **amount를 private으로 만들기**
> - ~~Dollar 부작용?~~
> - Money 반올림?
> - ~~equals()~~
> - hashCode()
> - Equal null
> - Equal object

- 오직 테스트를 향상시키기 위해서만 개발된 기능을 사용했다.
- 두 테스트가 동시에 실패하면 망한다는 점을 인식했다.
- 위험 요소가 있음에도 계속 진행했다.
- 테스트와 코드 사이의 결합도를 낮추기 위해, 테스트하는 객체의 새 기능을 사용했다.

## Step 5 Franc-ly Speaking

> - $5 + 10CHF = $10(환율이 2:1일 경우)
> - ~~$5 x 2  = $10~~
> - ~~amount를 private으로 만들기~~
> - ~~Dollar 부작용?~~
> - Money 반올림?
> - ~~equals()~~
> - hashCode()
> - Equal null
> - Equal object
> - **5CHF X 2 = 10CHF**
> - Dollar/Franc 중복
> - 공용 equals
> - 공용 times

- 큰 테스트를 공략할 수 없다. 그래서 진전을 나타낼 수 있는 자그마한 테스트를 만들었다.
- 뻔뻔스럽게도 중복을 만들고 조금 고쳐서 테스트를 작성했다.
- 설상가상으로 모델 코드까지 도매금으로 복사하고 수정해서 테스트를 통과했다.
- 중복이 사라지기 전에는 집에 가지 않겠다고 약속했다.

## Step 6 Equality for All, Redux

> - $5 + 10CHF = $10(환율이 2:1일 경우)
> - ~~$5 x 2  = $10~~
> - ~~amount를 private으로 만들기~~
> - ~~Dollar 부작용?~~
> - Money 반올림?
> - ~~equals()~~
> - hashCode()
> - Equal null
> - Equal object
> - ~~5CHF X 2 = 10CHF~~
> - Dollar/Franc 중복
> - **공용 equals**
> - 공용 times

- 공통된 코드를 첫 번째 클래스(Dollar)에서 상위 클래스(Money)로 단계적으로 옮겼다.
- 두 번째 클래스(Franc)도 Money의 하위 클래스로 만들었다.
- 불필요한 구현을 제거하기 전에 두 equals() 구현을 일치시켰다.

---

